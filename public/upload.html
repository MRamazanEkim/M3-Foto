<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Fotoƒüraf Y√ºkle - M3 Works</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column; /* Logo ve container dikey sƒ±ralansƒ±n */
      align-items: center;
      justify-content: flex-start; /* ƒ∞√ßerik yukarƒ±dan ba≈ülasƒ±n */
      padding: 40px 20px 20px; /* Biraz daha √ºst bo≈üluk */
    }

    .logo-wrapper {
      margin-bottom: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .logo-wrapper img {
      max-width: 220px;
      width: 60%;
      height: auto;
      display: block;
    }

    .container {
      background: white;
      border-radius: 20px;
      padding: 30px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      margin-top: 10px; /* Container'ƒ± logonun biraz altƒ±nda tut */
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      color: #333;
      font-size: 28px;
      margin-bottom: 8px;
    }

    .header p {
      color: #666;
      font-size: 16px;
    }

    .upload-area {
      border: 3px dashed #667eea;
      border-radius: 15px;
      padding: 40px 20px;
      text-align: center;
      background: #f8f9ff;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 20px;
    }

    .upload-area:hover {
      border-color: #764ba2;
      background: #f0f2ff;
    }

    .upload-area.dragover {
      border-color: #764ba2;
      background: #e8ebff;
      transform: scale(1.02);
    }

    .upload-icon {
      font-size: 64px;
      color: #667eea;
      margin-bottom: 15px;
    }

    .upload-text {
      color: #333;
      font-size: 18px;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .upload-subtext {
      color: #999;
      font-size: 14px;
    }

    input[type="file"] {
      display: none;
    }

    .preview-container {
      margin-top: 20px;
      display: none;
    }

    .preview-image {
      max-width: 100%;
      max-height: 400px;
      border-radius: 10px;
      margin-bottom: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .button-group {
      display: flex;
      gap: 10px;
    }

    button {
      flex: 1;
      padding: 15px 20px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-upload {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-upload:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-upload:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .btn-cancel {
      background: #f0f0f0;
      color: #333;
    }

    .btn-cancel:hover {
      background: #e0e0e0;
    }

    .message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      font-weight: 500;
      display: none;
    }

    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .message.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .file-name {
      margin-top: 10px;
      color: #667eea;
      font-size: 14px;
      font-weight: 500;
    }

    /* Mobil uyumlu d√ºzenlemeler */
    @media (max-width: 480px) {
      .container {
        padding: 20px;
      }

      .header h1 {
        font-size: 22px;
      }

      .logo-wrapper img {
        max-width: 180px;
        width: 70%;
      }
    }
  </style>
</head>
<body>
  <div class="logo-wrapper">
    <img src="Logo.png" alt="QNB Logo">
  </div>

  <div class="container">
    <div class="header">
      <h1>QNB Kƒ±dem √ñd√ºl T√∂reni</h1>
    </div>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">üìÅ</div>
      <div class="upload-text">Fotoƒüraf √ßekin ve y√ºkleyin</div>
      <div class="upload-subtext">Buraya tƒ±klayƒ±n</div>
    </div>

    <input type="file" id="fileInput" accept="image/*" capture="environment">

    <div class="preview-container" id="previewContainer">
      <img id="previewImage" class="preview-image" alt="√ñnizleme">
      <div class="file-name" id="fileName"></div>
      <div class="button-group">
        <button class="btn-cancel" id="btnCancel">ƒ∞ptal</button>
        <button class="btn-upload" id="btnUpload">Y√ºkle</button>
      </div>
    </div>

    <div class="message" id="message"></div>
  </div>

  <script>
    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const previewContainer = document.getElementById('previewContainer');
    const previewImage = document.getElementById('previewImage');
    const fileName = document.getElementById('fileName');
    const btnUpload = document.getElementById('btnUpload');
    const btnCancel = document.getElementById('btnCancel');
    const message = document.getElementById('message');
    let selectedFile = null;

    // Upload area'ya tƒ±klandƒ±ƒüƒ±nda
    uploadArea.addEventListener('click', () => {
      fileInput.click();
    });

    // Dosya se√ßildiƒüinde
    fileInput.addEventListener('change', (e) => {
      handleFileSelect(e.target.files[0]);
    });

    // Drag & Drop
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if (file && file.type.startsWith('image/')) {
        handleFileSelect(file);
      } else {
        showMessage('L√ºtfen bir resim dosyasƒ± se√ßin', 'error');
      }
    });

    // Dosya se√ßimini i≈üle
    function handleFileSelect(file) {
      if (!file || !file.type.startsWith('image/')) {
        showMessage('L√ºtfen bir resim dosyasƒ± se√ßin', 'error');
        return;
      }

      // Dosya boyutu kontrol√º (10MB)
      if (file.size > 10 * 1024 * 1024) {
        showMessage('Dosya boyutu 10MB\'dan b√ºy√ºk olamaz', 'error');
        return;
      }

      selectedFile = file;
      fileName.textContent = file.name;

      // √ñnizleme g√∂ster
      const reader = new FileReader();
      reader.onload = (e) => {
        previewImage.src = e.target.result;
        previewContainer.style.display = 'block';
        uploadArea.style.display = 'none';
        hideMessage();
      };
      reader.readAsDataURL(file);
    }

    // ƒ∞ptal butonu
    btnCancel.addEventListener('click', () => {
      selectedFile = null;
      fileInput.value = '';
      previewContainer.style.display = 'none';
      uploadArea.style.display = 'block';
      hideMessage();
    });

    // Y√ºkle butonu
    btnUpload.addEventListener('click', async () => {
      if (!selectedFile) return;

      btnUpload.disabled = true;
      btnUpload.innerHTML = '<span class="loading"></span>Y√ºkleniyor...';
      hideMessage();

      const formData = new FormData();
      formData.append('photo', selectedFile);

      try {
        const response = await fetch('/upload', {
          method: 'POST',
          body: formData
        });

        const result = await response.json();

        if (result.ok) {
          showMessage('‚úÖ Fotoƒüraf ba≈üarƒ±yla y√ºklendi!', 'success');
          // 2 saniye sonra formu sƒ±fƒ±rla
          setTimeout(() => {
            selectedFile = null;
            fileInput.value = '';
            previewContainer.style.display = 'none';
            uploadArea.style.display = 'block';
            btnUpload.disabled = false;
            btnUpload.textContent = 'Y√ºkle';
          }, 2000);
        } else {
          throw new Error(result.error || 'Y√ºkleme ba≈üarƒ±sƒ±z');
        }
      } catch (error) {
        console.error('Upload error:', error);
        showMessage('‚ùå Hata: ' + error.message, 'error');
        btnUpload.disabled = false;
        btnUpload.textContent = 'Y√ºkle';
      }
    });

    // Mesaj g√∂ster
    function showMessage(text, type = 'info') {
      message.textContent = text;
      message.className = 'message ' + type;
      message.style.display = 'block';
    }

    // Mesajƒ± gizle
    function hideMessage() {
      message.style.display = 'none';
    }
  </script>
</body>
</html>
